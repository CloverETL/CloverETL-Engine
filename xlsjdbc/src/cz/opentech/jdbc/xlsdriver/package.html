<html>
<head></head>
<body>
<h1>XLS JDBC Driver</h1>
<p>XLS JDBC driver acceses xls workbooks through standard JDBC API.
It supports selects only. Even the DML commands are executed correctly
all the modifications lasts until the connection is closed.
<p>The purpose of the driver is to load data from small or medium sized
excel workbooks to a database. It means
that this driver is not designed for performance or memory optimizations.</p>
<p>The driver uses internally HSQLDB. When initializing JDBC connection all data
from workbook are loaded to memory HSQL database and all JDBC commands are directed to it.</p>

<p>The rest of the document describes use of the driver and format of the URL.
Knowledge of Java programming environment, mainly JDBC API and ANT building utility
is assumed.</p>

<h2>Installation</h2>
<p>Driver can be built with ANT <code>build.xml</code> script. After the build
procedure proceeds in the home directory <code>xlsjdbc.jar</code>
library should appear.</p>
<p>The driver uses the following modules:<ul>
    <li>hsqldb.jar - <a href="http://hsqldb.sourceforge.net/">HSQL database</a>,</li>
    <li>jxl.jar - <a href="http://www.andykhan.com/jexcelapi/">JExcelAPI</a>.</li>
</ul></p>
<h2>JDBC URL</h2>
<p>The URL has the following format:
<pre>
	xls_jdbc_url ::= "jdbc:opentech:xls:" schema_list
	schema_list ::= schema_definition | ("{" schema_definition "}")
	schema_definition ::= (property_list | table_definition)*
	table_definition ::= "{" property_list "}"
	property_list ::= property_definition (";" property_definition)*
	property_definition ::= (value | property "=" value)
</pre>
URL must always start with prefix "jdbc:opentech:xls:". Then you have to specify
at least one schema definition. If you specify exactly one schema, you can ommit
the braces. The schema definition consists of list of properties and table
definitions. Schema definition maps a Excel workbook to a database schema.
Table definitions maps sheets to tables. Property list contains properties listed in
the table below. If no property identifier is provided (only value) the value is
meant to be a default property. For schema definition the default property is path
to workbook (property "file"). For table definition the default property
is table signature (property "name").

<h2>Schema properties</h2>
<table>
	<tr><th>Name</th><th>Description</th></tr>
	<tr><td><code>name</code></td><td>The name of schema.</td></tr>
	<tr><td><code>file</code></td><td>The path to the Excel workbook.</td></tr>
	<tr><td><code>dateformat</code></td><td>The format for parsing date from
	text cells. See java.text.SimpleDateFormat for details.</td></tr>
	<tr><td><code>rows</code></td><td>Default range of loaded rows from sheets
	of the workbook. For the format of the range see below.</td></tr>
	<tr><td><code>cols</code></td><td>Default range of loaded columns from sheets
	of the workbook. For the format of the range see below.</td></tr>
	<tr><td><code>head</code></td><td>Default range of header loaded from sheets
	of the workbook. For the format of the range see below.</td></tr>
</table>

<h2>Table properties</h2>
<table>
	<tr><th>Name</th><th>Description</th></tr>
	<tr><td><code>name</code></td><td>The name or signature of the table.</td></tr>
	<tr><td><code>dateformat</code></td><td>The format for parsing date from
	text cells. See java.text.SimpleDateFormat for details.</td></tr>
	<tr><td><code>rows</code></td><td>The range of loaded rows from sheets
	of the workbook. For the format of the range see below.</td></tr>
	<tr><td><code>cols</code></td><td>The range of loaded columns from sheets
	of the workbook. For the format of the range see below.</td></tr>
	<tr><td><code>head</code></td><td>The range of header loaded from sheets
	of the workbook. For the format of the range see below.</td></tr>
	<tr><td><code>rowsScanned</code></td><td>The number of rows scanned
	for automatic type analysis. Default value is 0 which means scan all rows.</td></tr>
</table>
<h2>Properties</h2>
<p>Property name is a case sensitive identifier. Actually you can use
all characters but those that separates properties and values and spaces
i.e. space characters, "=", ";", "}" and maybe else (depends on the URL format).</p>

<p>Property values can be wrapped in "'" is special chars are occuring.
The "'" is escaped when it is doubled.</p>

<h2>Format of the range properties <i>(rows, cols, head)</i></h2>

<p>The range is a set of integer intervals. The text representation is
a comma separated list of numbers (one element interval) or pair
from_number "-" to_number representing interval &lt;from_number,to_number&gt;.
If one number is missing then it is meant to be negative resp. positive infinity.</p>

<h2>Format of the table signature</h2>

<p>The signature can define table name, or table name with definition of columns
and its types. The format is <code>table_name [ "(" column_name column_type
( "," column_name column_type )* ")" ]</code>. Table name and column names are
values (see properties).
</p>
</body>
</html>