<?xml version="1.0" encoding="UTF-8"?>
<Graph author="Kokon" created="Wed Sep 16 10:19:19 CEST 2009" guiVersion="0.0.0.devel" id="1253101461188" licenseType="Evaluation Devel" modified="Fri Nov 19 15:05:13 CET 2010" modifiedBy="lucie" name="g" revision="1.367">
<Global>
<Metadata id="Metadata10">
<Record fieldDelimiter="|" name="ArrayOfForecast" recordDelimiter="\r\n" type="delimited">
<Field name="ArrayOfForecastId" type="string"/>
<Field name="ForecastReturnId" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata7" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="Forecast" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ForecastId" type="string"/>
<Field name="ArrayOfForecastId" type="string"/>
<Field format="yyy-MM-dd'T'HH:mm:ss" name="Date" type="date"/>
<Field name="WeatherID" type="string"/>
<Field name="Desciption" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata2" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="Forecast1" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ForecastId" type="string"/>
<Field name="ArrayOfForecastId" type="string"/>
<Field name="Date" type="date"/>
<Field name="WeatherID" type="string"/>
<Field name="Desciption" type="string"/>
<Field name="MorningLow" type="string"/>
<Field name="DaytimeHigh" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata3" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="ForecastResult" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="Date" type="date"/>
<Field name="City" type="string"/>
<Field name="State" type="string"/>
<Field name="Desciption" type="string"/>
<Field name="MorningLowF" type="string"/>
<Field name="DaytimeHighF" type="string"/>
<Field name="MorningLowC" type="string"/>
<Field name="DaytimeHighC" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata6" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="ForecastReturn" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ForecastReturnId" type="string"/>
<Field name="Success" type="string"/>
<Field name="ResponseText" type="string"/>
<Field name="State" type="string"/>
<Field name="City" type="string"/>
<Field name="WeatherStationCity" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata1" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="ForecastReturn1" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ForecastReturnId" type="string"/>
<Field name="Success" type="string"/>
<Field name="ResponseText" type="string"/>
<Field name="State" type="string"/>
<Field name="City" type="string"/>
<Field name="WeatherStationCity" type="string"/>
<Field name="ArrayOfForecastId" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata8" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="Temperature" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ForecastId" type="string"/>
<Field name="MorningLow" type="string"/>
<Field name="DaytimeHigh" type="string"/>
</Record>
</Metadata>
<Metadata id="Metadata5" previewAttachmentCharset="ISO-8859-1">
<Record fieldDelimiter="|" name="ZIP" previewAttachmentCharset="ISO-8859-1" recordDelimiter="\r\n" type="delimited">
<Field name="ZIP" type="string"/>
</Record>
</Metadata>
<Property fileURL="workspace.prm" id="GraphParameter0"/>
<Note alignment="1" backgroundColorB="0" backgroundColorG="196" backgroundColorR="255" folded="false" height="102" id="Note0" textColorB="0" textColorG="0" textColorR="0" textFontSize="12" title="Using Web Service tools" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="12" width="1101" x="5" y="8">
<attr name="text"><![CDATA[Example demonstrates a functional Web service providing a city forecast over the next 7 days (location identified by ZIP code) called by the WebServiceClient component. The results are returned in XML format which are then parsed, consolidated and written to an Excel file.
]]></attr>
</Note>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="418" id="Note1" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="WebServiceClient" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="215" x="157" y="132">
<attr name="text"><![CDATA[WSDL URL - defines the location of the web service description

OPERATION NAME - - defines selection of operation to be performed
HERE: GetCityWeatherByZIP operation (Port:WeatherSoap)

REQUEST STRUCTURE-   passes specified parameters to a webservice

RESPONSE MAPPING - indicates how the response is processed
]]></attr>
</Note>
<Note alignment="1" backgroundColorB="225" backgroundColorG="255" backgroundColorR="255" folded="false" height="234" id="Note2" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="F° -&gt; C°  conversion" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="154" x="773" y="322">
<attr name="text"><![CDATA[
- num2str / str2num CTL1 functions applied in the transformation fuction]]></attr>
</Note>
<Note alignment="1" backgroundColorB="96" backgroundColorG="255" backgroundColorR="96" folded="false" height="73" id="Note3" textColorB="0" textColorG="0" textColorR="0" textFontSize="10" title="Step-by-step tutorial available online" titleColorB="0" titleColorG="0" titleColorR="0" titleFontSize="10" width="510" x="414" y="136">
<attr name="text"><![CDATA[
http://blog.cloveretl.com/2010/03/08/how-to-set-up-a-webserviceclient-component-in-3-steps/]]></attr>
</Note>
<Dictionary/>
</Global>
<Phase number="0">
<Node enabled="enabled" guiHeight="0" guiName="ZIP code generator" guiWidth="0" guiX="2" guiY="439" id="DATA_GENERATOR1" recordsNumber="1" type="DATA_GENERATOR">
<attr name="generate"><![CDATA[//#TL

// Generates output record.
function generate() {
	$0.ZIP := "30310";
}

// Called to return a user-defined error message when an error occurs.
// function getMessage() {}

// Called during component initialization.
// function init() {}

// Called after the component finishes.
// function finished() {}
]]></attr>
</Node>
<Node enabled="enabled" guiHeight="0" guiName="Only success" guiWidth="0" guiX="432" guiY="317" id="EXT_FILTER0" type="EXT_FILTER">
<attr name="filterExpression"><![CDATA[$0.Success == 'true']]></attr>
</Node>
<Node enabled="enabled" guiHeight="0" guiName="Prepare header" guiWidth="0" guiX="598" guiY="402" id="EXT_MERGE_JOIN0" joinKey="$ForecastReturnId(a)#$ForecastReturnId(a);" type="EXT_MERGE_JOIN">
<attr name="transform"><![CDATA[//#TL

// Transforms input record into output record.
function transform() {
	$0.ForecastReturnId := $0.ForecastReturnId;
	$0.Success := $0.Success;
	$0.ResponseText := $0.ResponseText;
	$0.State := $0.State;
	$0.City := $0.City;
	$0.WeatherStationCity := $0.WeatherStationCity;
	$0.ArrayOfForecastId := $1.ArrayOfForecastId;
}

// Called to return a user-defined error message when an error occurs.
// function getMessage() {}

// Called during component initialization.
// function init() {}

// Called after the component finishes.
// function finished() {}
]]></attr>
</Node>
<Node enabled="enabled" guiHeight="0" guiName="Prepare details" guiWidth="0" guiX="432" guiY="501" id="EXT_MERGE_JOIN1" joinKey="$ForecastId(a)#$ForecastId(a);" type="EXT_MERGE_JOIN">
<attr name="transform"><![CDATA[//#TL

// Transforms input record into output record.
function transform() {
	$0.ForecastId := $0.ForecastId;
	$0.ArrayOfForecastId := $0.ArrayOfForecastId;
	$0.Date := $0.Date;
	$0.WeatherID := $0.WeatherID;
	$0.Desciption := $0.Desciption;
	$0.MorningLow := $1.MorningLow;
	$0.DaytimeHigh := $1.DaytimeHigh;
}

// Called to return a user-defined error message when an error occurs.
// function getMessage() {}

// Called during component initialization.
// function init() {}

// Called after the component finishes.
// function finished() {}
]]></attr>
</Node>
<Node enabled="enabled" guiHeight="0" guiName="Merge header and details" guiWidth="0" guiX="787" guiY="470" id="EXT_MERGE_JOIN2" joinKey="$ArrayOfForecastId(a)#$ArrayOfForecastId(a);" type="EXT_MERGE_JOIN">
<attr name="transform"><![CDATA[//#TL

// Transforms input record into output record.
function transform() {
	$0.State := $0.State;
	$0.City := $0.City;
	$0.Date := $1.Date;
	$0.Desciption := $1.Desciption;
	$0.MorningLowF := $1.MorningLow;
	$0.DaytimeHighF := $1.DaytimeHigh;
	$0.MorningLowC := nvl2($1.MorningLow, num2str((str2num($1.MorningLow)-32)*5/9),null);
	$0.DaytimeHighC := nvl2($1.DaytimeHigh, num2str((str2num($1.DaytimeHigh)-32)*5/9), null);
}

// Called to return a user-defined error message when an error occurs.
// function getMessage() {}

// Called during component initialization.
// function init() {}

// Called after the component finishes.
// function finished() {}
]]></attr>
</Node>
<Node enabled="enabled" guiHeight="0" guiName="Weather Forecast" guiWidth="0" guiX="206" guiY="445" id="WEB_SERVICE_CLIENT1" operationName="{http://ws.cdyne.com/WeatherWS/}Weather#WeatherSoap12#GetCityForecastByZIP" requestStructure="&lt;GetCityForecastByZIP xmlns=&quot;http://ws.cdyne.com/WeatherWS/&quot;&gt;&#10;&#9;&lt;ZIP&gt;$ZIP&lt;/ZIP&gt;&#10;&lt;/GetCityForecastByZIP&gt;" responseMapping="&lt;Mappings&gt;&#13;&#10;&#9;&lt;Mapping element=&quot;GetCityForecastByZIPResponse&quot;&gt;&#13;&#10;&#9;&#9;&lt;Mapping element=&quot;GetCityForecastByZIPResult&quot; outPort=&quot;0&quot; sequenceField=&quot;ForecastReturnId&quot;&gt;&#13;&#10;&#9;&#9;&#9;&lt;Mapping element=&quot;ForecastResult&quot; outPort=&quot;1&quot; parentKey=&quot;ForecastReturnId&quot; generatedKey=&quot;ForecastReturnId&quot; sequenceField=&quot;ArrayOfForecastId&quot;&gt;&#13;&#10;&#9;&#9;&#9;&#9;&lt;Mapping element=&quot;Forecast&quot; outPort=&quot;2&quot; parentKey=&quot;ArrayOfForecastId&quot; generatedKey=&quot;ArrayOfForecastId&quot; sequenceField=&quot;ForecastId&quot;&gt;&#13;&#10;&#9;&#9;&#9;&#9;&#9;&lt;Mapping element=&quot;Temperatures&quot; outPort=&quot;3&quot; parentKey=&quot;ForecastId&quot; generatedKey=&quot;ForecastId&quot;/&gt;&#13;&#10;&#9;&#9;&#9;&#9;&lt;/Mapping&gt;&#13;&#10;&#9;&#9;&#9;&lt;/Mapping&gt;&#13;&#10;&#9;&#9;&lt;/Mapping&gt;&#13;&#10;&#9;&lt;/Mapping&gt;&#13;&#10;&lt;/Mappings&gt;&#13;&#10;" type="WEB_SERVICE_CLIENT" wsdlURL="http://ws.cdyne.com/WeatherWS/Weather.asmx?wsdl"/>
<Node enabled="enabled" fileURL="${DATAOUT_DIR}/delimited/WeatherForecast.xls" guiHeight="0" guiName="Forecast in XLS" guiWidth="0" guiX="978" guiY="393" id="XLS_WRITER0" namesRow="1" type="XLS_WRITER"/>
<Edge debugMode="true" fromNode="DATA_GENERATOR1:0" guiBendpoints="" guiRouter="Manhattan" id="Edge2" inPort="Port 0 (request)" metadata="Metadata5" outPort="Port 0 (out)" toNode="WEB_SERVICE_CLIENT1:0"/>
<Edge fromNode="EXT_FILTER0:0" guiBendpoints="" guiRouter="Manhattan" id="Edge0" inPort="Port 0 (driver)" metadata="Metadata6" outPort="Port 0 (accepted)" toNode="EXT_MERGE_JOIN0:0"/>
<Edge debugMode="true" fromNode="EXT_MERGE_JOIN0:0" guiBendpoints="" guiRouter="Manhattan" id="Edge3" inPort="Port 0 (driver)" metadata="Metadata1" outPort="Port 0 (out)" toNode="EXT_MERGE_JOIN2:0"/>
<Edge debugMode="true" fromNode="EXT_MERGE_JOIN1:0" guiBendpoints="" guiRouter="Manhattan" id="Edge4" inPort="Port 1 (slave)" metadata="Metadata2" outPort="Port 0 (out)" toNode="EXT_MERGE_JOIN2:1"/>
<Edge debugMode="true" fromNode="EXT_MERGE_JOIN2:0" guiBendpoints="" guiRouter="Manhattan" id="Edge6" inPort="Port 0 (in)" metadata="Metadata3" outPort="Port 0 (out)" toNode="XLS_WRITER0:0"/>
<Edge debugMode="true" fromNode="WEB_SERVICE_CLIENT1:0" guiBendpoints="63:0:-35:122:0.5|63:-122:-35:0:0.5" guiRouter="Manual" id="Edge1" inPort="Port 0 (in)" metadata="Metadata6" outPort="Port 0 (response)" toNode="EXT_FILTER0:0"/>
<Edge debugMode="true" fromNode="WEB_SERVICE_CLIENT1:1" guiBendpoints="" guiRouter="Manhattan" id="Edge9" inPort="Port 1 (slave)" metadata="Metadata10" outPort="Port 1 (response)" toNode="EXT_MERGE_JOIN0:1"/>
<Edge debugMode="true" fromNode="WEB_SERVICE_CLIENT1:2" guiBendpoints="" guiRouter="Manhattan" id="Edge5" inPort="Port 0 (driver)" metadata="Metadata7" outPort="Port 2 (response)" toNode="EXT_MERGE_JOIN1:0"/>
<Edge debugMode="true" fromNode="WEB_SERVICE_CLIENT1:3" guiBendpoints="27:0:-71:-36:0.5|27:36:-71:0:0.5" guiRouter="Manual" id="Edge7" inPort="Port 1 (slave)" metadata="Metadata8" outPort="Port 3 (response)" toNode="EXT_MERGE_JOIN1:1"/>
</Phase>
</Graph>
