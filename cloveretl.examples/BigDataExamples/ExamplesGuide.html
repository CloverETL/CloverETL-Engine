<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1250">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=CS link=blue vlink=purple>

<div class=WordSection1>

<p class=MsoNormal><b><span lang=EN-US>Why this guide?</span></b></p>

<p class=MsoNormal><span lang=EN-US>Starting with CloverETL 3.4M2 we provide
integration with technologies from the Apache Hadoop stack: HDFS, Hive and
MapReduce.  All these technologies are still under active development with
major changes to API, class structure, and library names happening frequently
between releases. </span></p>

<p class=MsoNormal><span lang=EN-US>CloverETL integration with Hadoop is
therefore not bound to any particular Hadoop distribution and should work with
various versions of Hadoop technologies. CloverETL supports both MapReduce 1.0 (available
in CDH3 and CDH4) as well as MapReduce 2.0 with YARN (available only in CDH4). </span></p>

<p class=MsoNormal><span lang=EN-US>Within the MapReduce 1.0 framework CloverETL
support submission of jobs developed with both the old <i>org.apache.hadoop.mapred.*</i>
as well as the new <i>org.apache.hadoop.mapreduce.*</i> map-reduce API.</span></p>

<p class=MsoNormal><span lang=EN-US>To interact with Hadoop from CloverETL you
will need to configure CloverETL with<b> the correct Hadoop libraries taken directly
from your installation of Hadoop. </b>Just a friendly advice: don’t even try to
copy random JAR from the internet. You have been warned.™</span></p>

<p class=MsoNormal><span lang=EN-US>This guide intends to help you with both
the setup of jobs and necessary Hadoop libraries and to verify the setup using jobs
from our prepackaged <i>BigDataExamples.</i> </span></p>

<p class=MsoNormal><b><span lang=EN-US>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US>Example scenario and job structure</span></b></p>

<p class=MsoNormal><span lang=EN-US>The example jobs implement the following
SQL statement in three different technologies: using Hive SQL query, MapReduce
and in pure CloverETL:</span></p>

<p class=MsoNormal style='margin-left:134.7pt'><b><span lang=EN-US
style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>select</span></b><span
lang=EN-US style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>
monthOfYear, count(distinct(ipAddress))</span></p>

<p class=MsoNormal style='margin-left:134.7pt'><b><span lang=EN-US
style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>from</span></b><span
lang=EN-US style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>
weblog</span></p>

<p class=MsoNormal style='margin-left:134.7pt'><b><span lang=EN-US
style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>group</span></b><span
lang=EN-US style='font-size:9.0pt;line-height:115%;font-family:"Courier New"'>
by monthOfYear</span></p>

<p class=MsoNormal><span lang=EN-US>In human language “<i>What is the number of
unique visitors (of our site) each month?”</i></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>The different approaches are represented by
three different jobflows and graphs.</span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span lang=EN-US>jobflow/UniqueVisits-CloverETL.jbf</span></i></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Implements pure CloverETL approach.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Does not need any HDFS or Hive connection. </span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Uses the following ETL graphs:</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/CloverETL-CountVisits.grf</span></i><span
lang=EN-US> to calculate the metric into temp file.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/GenerateReport.grf
</span></i><span lang=EN-US>to produce the Excel report from temp file.</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span lang=EN-US>jobflow/UniqueVisits-HadoopHive.jbf</span></i></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Implements Hive-based approach</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Needs both HDFS and Hive connection</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Uses the following ETL graphs:</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/CheckParameters-Hive.grf</span></i><span
lang=EN-US> to check that Hive and HDFS parameters are set</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/PrepareInputData.grf</span></i><span
lang=EN-US> to parse input data and upload on HDFS</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/HadoopHive-LoadData.grf</span></i><span
lang=EN-US> to bulk-load data from HDFS to Hive</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/HadoopHive-CountVisits.grf</span></i><span
lang=EN-US> to calculate the metric using Hive SQL to temp file</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/GenerateReport.grf</span></i><span
lang=EN-US> to produce the Excel report from temp file</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i><span lang=EN-US>jobflow/UniqueVisits-HadoopMapReduce.jbf</span></i></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Implements MapReduce-based approach</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Needs HDFS connection with MapReduce configured</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span lang=EN-US>Uses the following ETL graphs:</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/CheckParameters-MapReduce.grf</span></i><span
lang=EN-US> to check that HDFS and MapReduce parameters set</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/PrepareInputData.grf</span></i><span
lang=EN-US> to parse input data and upload on HDFS</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US>Submits
a MapReduce job from <i>lib/hadoop/mapreduce-job-definition/UniqueVisits.jar </i>to
calculate the metric into a HDFS file.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:108.0pt;text-indent:
-18.0pt'><span lang=EN-US style='font-family:Wingdings'>§<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i><span lang=EN-US>graph/HadoopMapReduce-CountVisits.grf</span></i><span
lang=EN-US> to download the file</span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:108.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Wingdings'>§<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><i><span lang=EN-US>graph/GenerateReport.grf</span></i><span
lang=EN-US> to produce the Excel report from temp file</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US>Making the examples work</span></b></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-18.0pt'><b><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><span lang=EN-US>Pick your codebase. This </span><a
href="https://blogs.apache.org/bigtop/entry/all_you_wanted_to_know">https://blogs.apache.org/bigtop/entry/all_you_wanted_to_know</a>
 <span lang=EN-US>will help you decide.</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>CDH3 (hadoop-0.20, mapreduce-1.0) </span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>CDH4 (hadoop-0.23, mapreduce-1.0 or 2.0 with
YARN)</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><b><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><span lang=EN-US>Find library location for HDFS and MapReduce
connection:</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>For CDH3 use connections referencing: <i>BigDataExamples/lib/hadoop/cdh3u5</i></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>For CDH4 use connections referencing: <i>BigDataExamples/lib/hadoop/cdh412</i></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><span
lang=EN-US style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Hive libraries work for both CDH3 and CDH4: <i>BigDataExamples/lib/hive/cdh3u5</i></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt'><b><span
lang=EN-US>&nbsp;</span></b></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><i><span
lang=EN-US>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>The jobs are configured to use CDH3
connection. If you need CDH4 you will need to update the jobs as follows:</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><i><span
lang=EN-US>a.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>Go through all the jobs, delete CDH3
connection and link CDH4 connection instead</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt;text-indent:-18.0pt'><i><span
lang=EN-US>b.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>In Reader, Writer, ExecuteMapReduce select
CDH4 connection instead of CDH3</span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:72.0pt'><i><span
lang=EN-US>&nbsp;</span></i></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><i><span
lang=EN-US>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>If you need Hive copy the necessary
libraries into <i>BigDataExamples/lib/hive/cdh3u5. </i>If you do not have
CDH-3u5 libraries, updated class path to reference your JARs in connection
definition.</span></p>

<p class=MsoListParagraphCxSpMiddle><i><span lang=EN-US>&nbsp;</span></i></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-18.0pt'><i><span
lang=EN-US>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>Set parameters in jobflow graph for your Hive
URL or HDFS cluster settings. These will be propagated to child jobs.</span></p>

<p class=MsoListParagraphCxSpMiddle><i><span lang=EN-US>&nbsp;</span></i></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-18.0pt'><i><span
lang=EN-US>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></i><span lang=EN-US>Start the jobflow.<a name=AppendixA></a></span></p>

</div>

</body>

</html>
